<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../assets/style.css?t=a44c9e9d">
    <link rel="stylesheet" href="http://ricostacruz.com/docpress-rsc/style.css">
    <script src="../assets/script.js?t=2bcc4b59"></script>
    <title>Components</title>
    <meta name="viewport" content="width=device-width">
  </head>
  <body class="-menu-visible">
    <div class="doc-layout">
      <div class="toggle menu-toggle js-menu-toggle"></div>
      <div class="body page-components">
        <div class="header-nav">
          <div class="right"><a href="https://github.com/jails-org" data-title="jails-org" class="iconlink">
              <!-- span.title Open in GitHub--><span class="icon -github"></span></a>
          </div>
        </div>
        <div class="markdown-body"><h1 class="massive-header -with-tagline" id="components">Components</h1>
<blockquote>
<p>HTML &amp; Javascript</p>
</blockquote>
<ul>
<li>Components can live in the same markup</li>
<li>Uses <strong><em>Event delegation</em></strong></li>
<li>Uses <strong><em>Custom events</em></strong></li>
<li>Uses <strong><em>Publish &amp; Subscribe</em></strong> patterns</li>
<li>Can execute <strong><em>public methods</em></strong> of other Components</li>
<li><strong><em>@Annotations</em></strong></li>
</ul>
<h2 id="relashionship">Relashionship</h2>
<p>Components can relate to each other using <code>events</code>:</p>
<ul>
<li><strong><code>on()</code></strong> : Listening to DOM events. The same interface of jQuery to bind dom events.</li>
<li><strong><code>emit()</code></strong> : Fires a custom <em>DOM</em> event.</li>
<li><strong><code>publish()</code></strong> : Publish a global event to every component in the page.</li>
<li><strong><code>subscribe()</code></strong> : Subscribe to any global events.</li>
<li><strong><code>get()</code></strong> : Get a function reference to a component.</li>
</ul>
<h3 id="listening-to-events">Listening to events</h3>
<h4 id="example">Example</h4>
<p><em>Component A listen to Component B</em></p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;A&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Ok<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>Custom events are events using <code>:</code> symbol at the beginning.</p>
<p><strong><em>Component A</em></strong> :</p>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails-js&apos;</span>

jails(<span class="pl-s">&apos;A&apos;</span>, ({init, on}) =&gt;{

    init(()=&gt;{
        on(<span class="pl-s">&apos;:customclick&apos;</span>, e =&gt; <span class="pl-c1">console</span>.log(e))
    })
})
</code></pre>
<p><strong><em>Component B</em></strong> :</p>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails&apos;</span>

jails(<span class="pl-s">&apos;B&apos;</span>, ({init, on, emit}) =&gt;{

    init(()=&gt;{
        on(<span class="pl-s">&apos;click&apos;</span>, {<span class="pl-s">&apos;.button&apos;</span>:send})
    })

    <span class="pl-k">const</span> send = e =&gt;{
        emit(<span class="pl-s">&apos;:customclick&apos;</span>, e)
    }
})
</code></pre>
<p>Event delegation can be used to specify dispatching element:</p>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails-js&apos;</span>

jails(<span class="pl-s">&apos;A&apos;</span>, ({init, on}) =&gt;{

    init(()=&gt;{
        on(<span class="pl-s">&apos;:customclick&apos;</span>, {<span class="pl-s">&apos;.the-element&apos;</span>: (e)=&gt; <span class="pl-c1">console</span>.log(e) })
    })
})

</code></pre>
<h3 id="executing-another-component&apos;s-method">Executing another component&#x2019;s method</h3>
<p>You can execute a public method through other component getting component with <strong>.get()</strong> function.</p>
<h4 id="example">Example</h4>
<p>Component <strong>A</strong> executes Component <strong>B&#x2019;s</strong> public method.</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;A&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Ok<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><strong><em>Component A</em></strong> :</p>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails-js&apos;</span>

jails(<span class="pl-s">&apos;A&apos;</span>, ({init, get}) =&gt;{

    <span class="pl-c">//Getting B reference</span>
    <span class="pl-k">let</span> B = get(<span class="pl-s">&apos;B&apos;</span>)

    init = ()=&gt;{
        B(<span class="pl-s">&apos;update&apos;</span>, { someOption:<span class="pl-s">&apos;bla bla bla&apos;</span> })
    }
})
</code></pre>
<p><strong><em>Component B</em></strong>:</p>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails&apos;</span>

jails(<span class="pl-s">&apos;B&apos;</span>, ( {init, expose, publish} ) =&gt;{

    init(()=&gt;{
        <span class="pl-c">//update is private, so you need to expose it, to be visible to other components.</span>
        expose( {update} )
    })

    <span class="pl-k">const</span> update = (option)=&gt;{
        <span class="pl-c1">console</span>.log( option ) <span class="pl-c">// { someOption:&apos;bla bla bla&apos; }</span>
        publish(<span class="pl-s">&apos;messageToALL&apos;</span>, { mydata:<span class="pl-s">&apos;somedata&apos;</span> }) <span class="pl-c">// Sends data to any component subscribed to &apos;messageToALL&apos;.</span>
    }
})
</code></pre>
<p>The <code>.get()</code> function does not returns an instance, but a reference instead which is a <code>Function</code>. That&#x2019;s because you can have several components in the markup, all of them should execute the public method without the looping concerns:</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;A&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Ok<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><code>.get( String name [, String CSSSelector] )</code> method also expects a <code>CSSSelector</code> as a second parameter to specify html element:</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;A&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="pl-s">&quot;only-this-one&quot;</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Ok<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails&apos;</span>

jails(<span class="pl-s">&apos;A&apos;</span>, ({init, get}) =&gt;{

    <span class="pl-c">//Getting B reference</span>
    <span class="pl-k">let</span> B = get(<span class="pl-s">&apos;B&apos;</span>, <span class="pl-s">&apos;.only-this-one&apos;</span>)

    init(()=&gt;{
        B(<span class="pl-s">&apos;update&apos;</span>, { someOption:<span class="pl-s">&apos;bla bla bla&apos;</span> }) <span class="pl-c">// Only the second component will call .update() method.</span>
    })
})
</code></pre>
<h1 id="annotations">Annotations</h1>
<p>In order to build a generic component in some cases you need to let it configurable, without changing the source code.
You can use the html data attributes to accomplish that, or you can use Jails <code>@annotations</code>.</p>
<pre><code class="lang-html">    <span class="pl-c">&lt;!--@my-component({ target:&apos;.other-element&apos; })--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="pl-s">&quot;#&quot;</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;my-component&quot;</span>&gt;</span>
        My Link component
    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</code></pre>
<pre><code class="lang-js">    jails(<span class="pl-s">&apos;my-component&apos;</span>, ({init, annotation}) =&gt;{

        init(()=&gt;{
            <span class="pl-c1">console</span>.log( annotation.target ) <span class="pl-c">// &apos;other-element&apos;   </span>
        })

    })
</code></pre>
<p>Annotations is just a special comment, the name of component should be referenced in the comment using <code>@</code> prefix.
In the case with 2 or more components in the same markup:</p>
<pre><code class="lang-html">    <span class="pl-c">&lt;!--
    @A({  })
    @B({  })
    @C({  })
    --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="pl-s">&quot;#&quot;</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;A B C&quot;</span>&gt;</span>
    My Link component
    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</code></pre>
<p><strong>Annotations are optional, if you don&#x2019;t like to mix html comments with your js code, simply don&#x2019;t use it. =)</strong></p>
<h2 id="components-api">Components - API</h2>
<h4 id=".init(-function-)">.init( Function )</h4>
<blockquote>
<p>Init is a lazy function that will be called once component is ready. If the callback returns an Array, Jails will execute them in the array order sending all component interface.</p>
</blockquote>
<pre><code class="lang-js"><span class="pl-c">//...</span>
init(()=&gt;[
    firstCallback,
    secondCallback,
    <span class="pl-c">//...so on</span>
])

<span class="pl-k">const</span> firstCallback = ({on})=&gt;{
    on(<span class="pl-s">&apos;click&apos;</span>, ...)
}

<span class="pl-k">const</span> secondCallback = ({subscribe})=&gt;{
    subscribe(<span class="pl-s">&apos;something&apos;</span>, ()=&gt;{ <span class="pl-c1">console</span>.log(<span class="pl-s">&apos;something&apos;</span>) })
}

<span class="pl-c">// Etc, etc</span>


</code></pre>
<h4 id=".elm">.elm</h4>
<blockquote>
<p>The <code>htmlElement</code> node.</p>
</blockquote>
<h4 id=".on(-event-function-)">.on( Event, Function )</h4>
<blockquote>
<p>Bind DOM events on the component itself.</p>
</blockquote>
<h4 id=".on(-event-object-)">.on( Event, Object )</h4>
<blockquote>
<p>Event delegation, bind DOM events on component child nodes.
E.g <code>.on(&apos;submit&apos;, {&apos;form&apos;:callback })</code></p>
</blockquote>
<h4 id=".off(-event-function-)">.off( Event, Function )</h4>
<blockquote>
<p>Removes an event handler, just like <code>jQuery</code> api.</p>
</blockquote>
<h4 id=".trigger(-element-event-args-)">.trigger( element, event, [args] )</h4>
<blockquote>
<p>Trigger events on some element. Element is required&#x2026;</p>
</blockquote>
<h4 id=".props(-string-key-)">.props( [String key] )</h4>
<blockquote>
<p>Get a single property or a set of <code>htmlElement</code> properties.</p>
</blockquote>
<h4 id=".annotations(-string-key-)">.annotations( [String key] )</h4>
<blockquote>
<p>Get a single property or a set of <code>@annotations</code> properties.</p>
</blockquote>
<h4 id=".emit(-action-data-)">.emit( action, [ data ] )</h4>
<blockquote>
<p>Emit a custom event to be bubbled in the DOM tree.</p>
</blockquote>
<h4 id=".expose(-object-)">.expose( Object )</h4>
<blockquote>
<p>Exposes a set of functions to be public.</p>
</blockquote>
<h4 id=".get(-string-cssselector-)">.get( String, [ CssSelector ] )</h4>
<blockquote>
<p>Creates an reference to a component and returns a function, that accepts as first argument a string with the public method and the rest arguments can be used for passing values.</p>
</blockquote>
<h4 id=".publish(-event-args-)">.publish( Event, [args] )</h4>
<blockquote>
<p>Fires a global event to the ecosystem, very recommended to communicate Controllers and Apps with each other.</p>
</blockquote>
<h4 id=".subscribe(-event-function-)-:-function-unsubscribe">.subscribe( Event, Function ) : Function unsubscribe</h4>
<blockquote>
<p>Subscribes the Controller/App to a global event. Returns a function to unsubscribe if necessary.</p>
</blockquote>

        </div>
        <div class="footer-nav">
          <div class="left"><a href="../getting-started/index.html"><span class="title">Getting Started</span></a></div>
          <div class="right"><a href="../jails-api/index.html"><span class="label">Next: </span><span class="title">Jails API</span></a></div>
        </div>
      </div>
      <div class="menu toc-menu">
        <li class="menu-item -level-0 -parent">
          <ul class="submenu">
            <li class="menu-item -level-1"><a href="../index.html" class="link title  link-index">Jails</a>
            </li>
            <li class="menu-item -level-1 -parent"><a href="../getting-started/index.html" class="link title  link-getting-started">Getting Started</a>
              <ul class="submenu">
                <li class="menu-item -level-2">
                </li>
              </ul>
            </li>
            <li class="menu-item -level-1 -parent"><a href="../components/index.html" class="link title -active link-components">Components</a>
              <ul class="headings heading-list">
                <li class="heading-item -depth-2"><a href="#relashionship" class="hlink link-relashionship">Relashionship</a>
                  <ul class="heading-list -depth-2">
                    <li class="heading-item -depth-3"><a href="#listening-to-events" class="hlink link-listening-to-events">Listening to events</a>
                    </li>
                    <li class="heading-item -depth-3"><a href="#executing-another-component's-method" class="hlink link-executing-another-component's-method">Executing another component's method</a>
                    </li>
                  </ul>
                </li>
                <li class="heading-item -depth-2"><a href="#components-api" class="hlink link-components-api">Components - API</a>
                </li>
              </ul>
              <ul class="submenu">
                <li class="menu-item -level-2">
                </li>
              </ul>
            </li>
            <li class="menu-item -level-1 -parent"><a href="../jails-api/index.html" class="link title  link-jails-api">Jails API</a>
              <ul class="submenu">
                <li class="menu-item -level-2">
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </div>
    </div>
  </body>
</html>
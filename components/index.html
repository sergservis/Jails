<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../assets/style.css?t=a44c9e9d">
    <link rel="stylesheet" href="http://ricostacruz.com/docpress-rsc/style.css">
    <script src="../assets/script.js?t=820b7ffa"></script>
    <title>Components</title>
    <meta name="viewport" content="width=device-width">
  </head>
  <body class="-menu-visible">
    <div class="doc-layout">
      <div class="toggle menu-toggle js-menu-toggle"></div>
      <div class="body page-components">
        <div class="header-nav">
          <div class="right"><a href="https://github.com/jails-org" data-title="jails-org" class="iconlink">
              <!-- span.title Open in GitHub--><span class="icon -github"></span></a>
          </div>
        </div>
        <div class="markdown-body"><h1 class="massive-header -with-tagline" id="components">Components</h1>
<blockquote>
<p>HTML &amp; Javascript</p>
</blockquote>
<ul>
<li>Components can live in the same markup</li>
<li>Uses <strong><em>Event delegation</em></strong></li>
<li>Uses <strong><em>Custom events</em></strong></li>
<li>Uses <strong><em>Publish &amp; Subscribe</em></strong> patterns</li>
<li>Can execute <strong><em>public methods</em></strong> of other Components</li>
<li><strong><em>@Annotations</em></strong></li>
</ul>
<h1 id="relashionship">Relashionship</h1>
<p>Components can relate to each other using <code>events</code>:</p>
<ul>
<li><strong><code>.on()</code></strong> : The same interface of jQuery to bind dom events.</li>
<li><strong><code>.listen()</code></strong>: Is the way to listen to custom <em>DOM</em> event fired by other Components.</li>
<li><strong><code>.emit()</code></strong> : Fires the custom <em>DOM</em> event.</li>
<li><strong><code>.publish()</code></strong> : Publish globally to every component in the page.</li>
<li><strong><code>.subscribe()</code></strong> : Subscribe to any global events.</li>
<li><strong><code>.get()</code></strong> : Get a function reference to a component.</li>
</ul>
<h2 id="passive-way">Passive way</h2>
<h3 id="example">Example</h3>
<p><em>Component A listen to Component B</em></p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;A&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Ok<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>To listen to a custom event, you need to follow the standard <strong>componentName:stringEvent</strong>.</p>
<p><strong><em>Component A</em></strong> :</p>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails&apos;</span>

jails(<span class="pl-s">&apos;A&apos;</span>, (component, div, annotation) =&gt;{

    component.init = ()=&gt;{
        <span class="pl-c">// To listen to a custom event, you need to follow the standard</span>
        <span class="pl-c">// componentName:stringEvent</span>
        component.listen(<span class="pl-s">&apos;B:click&apos;</span>, e =&gt; <span class="pl-c1">console</span>.log(e))
    }
})
</code></pre>
<p><strong><em>Component B</em></strong> :</p>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails&apos;</span>

jails(<span class="pl-s">&apos;B&apos;</span>, (component, div, annotation) =&gt;{

    component.init = ()=&gt;{
        component.on(<span class="pl-s">&apos;click&apos;</span>, <span class="pl-s">&apos;.button&apos;</span>, emit)
    }

    <span class="pl-k">let</span> emit = (e)=&gt;{
        component.emit(<span class="pl-s">&apos;click&apos;</span>, e)
    }
})
</code></pre>
<h2 id="active-way">Active way</h2>
<p>You can execute a public component method through other component using the <strong>.get()</strong> function.</p>
<h3 id="example">Example</h3>
<p>Component <strong>A</strong> executes Component <strong>B&#x2019;s</strong> public method.</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;A&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Ok<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><strong><em>Component A</em></strong> :</p>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails&apos;</span>

jails(<span class="pl-s">&apos;A&apos;</span>, (component, div, annotation) =&gt;{

    <span class="pl-c">//Getting B reference</span>
    <span class="pl-k">let</span> B = component.get(<span class="pl-s">&apos;[data-component*=B]&apos;</span>)

    component.init = ()=&gt;{
        B(<span class="pl-s">&apos;update&apos;</span>, { someOption:<span class="pl-s">&apos;bla bla bla&apos;</span> })
    }
})
</code></pre>
<p><strong><em>Component B</em></strong>:</p>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails&apos;</span>

jails(<span class="pl-s">&apos;B&apos;</span>, ( component, div, annotation ) =&gt;{

    component.update = ( option )=&gt;{
        <span class="pl-c1">console</span>.log( option ) <span class="pl-c">// { someOption:&apos;bla bla bla&apos; }</span>
        component.publish(<span class="pl-s">&apos;messageToALL&apos;</span>, someOption) <span class="pl-c">// Sends data to any component subscribed to &apos;messageToALL&apos;.</span>
    }
})
</code></pre>
<p>The <code>.get()</code> function does not returns an instance, but a reference instead which is a <code>Function</code>. That&#x2019;s because you can have several components in the markup, all of them should execute the public method without the looping concerns:</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;A&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Ok<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><code>.get( CSSSelector )</code> method also expects a <code>CSSSelector</code> as a parameter you can grab the exactly component you want:</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;A&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="pl-s">&quot;only-this-one&quot;</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Ok<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="lang-js"><span class="pl-k">import</span> jails <span class="pl-k">from</span> <span class="pl-s">&apos;jails&apos;</span>

jails(<span class="pl-s">&apos;A&apos;</span>, (component, div, annotation) =&gt;{

    <span class="pl-c">//Getting B reference</span>
    <span class="pl-k">let</span> B = component.get(<span class="pl-s">&apos;.only-this-one&apos;</span>)

    component.init = ()=&gt;{
        B(<span class="pl-s">&apos;update&apos;</span>, { someOption:<span class="pl-s">&apos;bla bla bla&apos;</span> }) <span class="pl-c">// Only the second component will call .update() method.</span>
    }
})
</code></pre>
<h1 id="good-to-know">Good to Know</h1>
<p>Components can live in the same markup:</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;Z&quot;</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="pl-s">&quot;dialog&quot;</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;modal view&quot;</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hello {username}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>And if both has the methods with the same name, you can distinct which component should respond to the call:</p>
<h3 id="example">Example</h3>
<p>Modal and View components has the .update() method but you want that only View component to execute it:</p>
<pre><code class="lang-js">jails(<span class="pl-s">&apos;Z&apos;</span>, ( component, html, annotation ) =&gt;{

	<span class="pl-k">let</span> dialog = component.get(<span class="pl-s">&apos;.dialog&apos;</span>)

	component.init = ()=&gt;{
		dialog(<span class="pl-s">&apos;view:update&apos;</span>, { username:<span class="pl-s">&apos;Clark Kent&apos;</span> })
	}
})
</code></pre>
<p>You can create a new component and compose it with the jails component interface to build your components:</p>
<pre><code class="lang-js">jails(<span class="pl-s">&apos;My-Component&apos;</span>, ( component, html, annotation ) =&gt;{

	<span class="pl-c">// Returning a new component that uses the jails component interface</span>
	<span class="pl-k">return</span>{

		init(){
			<span class="pl-c">//Components supports event delegation!</span>
			<span class="pl-c">// You should always use that =)</span>
			component.on(<span class="pl-s">&apos;click&apos;</span>, <span class="pl-s">&apos;.button&apos;</span>, <span class="pl-k">this</span>.click)
		},

		click(){
			<span class="pl-c1">console</span>.log(<span class="pl-s">&apos;Hey I was clicked!&apos;</span>)
		}
	})
})
</code></pre>
<p>if you don&#x2019;t want to return a component object, jails will use the component interface argument as default.</p>
<h1 id="annotations">Annotations</h1>
<p>In order to build a generic component in some cases you need to let it configurable, without changing the source code.
You can use the html data attributes to accomplish that, or you can use Jails <code>@annotations</code>.</p>
<pre><code class="lang-html">	<span class="pl-c">&lt;!--@my-component({ target:&apos;.other-element&apos; })--&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="pl-s">&quot;#&quot;</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;my-component&quot;</span>&gt;</span>
		My Link component
	<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</code></pre>
<pre><code class="lang-js">	jails(<span class="pl-s">&apos;my-component&apos;</span>, (component, link, annotation) =&gt;{

		component.init = ()=&gt;{
			<span class="pl-c1">console</span>.log( annotation.target ) <span class="pl-c">// &apos;other-element&apos;</span>
		}

	})
</code></pre>
<p>Annotations is just a special comment, the name of component should be referenced in the comment using <code>@</code> prefix.
In the case with 2 or more components in the same markup:</p>
<pre><code class="lang-html">	<span class="pl-c">&lt;!--
		@A({  })
		@B({  })
		@C({  })
	--&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="pl-s">&quot;#&quot;</span> <span class="hljs-attr">data-component</span>=<span class="pl-s">&quot;A B C&quot;</span>&gt;</span>
		My Link component
	<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</code></pre>
<p><strong>Annotations are optional, if you don&#x2019;t like to mix html comments with your js code, simply don&#x2019;t use it. =)</strong></p>
<h1 id="api">Api</h1>
<h4 id=".on(-event-function-)">.on( Event, Function )</h4>
<p>Bind DOM events on the component itself.</p>
<h4 id=".on(-event-cssselector-function-)-:-function-off()">.on( Event, CssSelector, Function ) : Function off()</h4>
<p>Event delegation, bind DOM events on component child nodes. Returns the <code>.off()</code> method to unbind the event.</p>
<h4 id=".trigger(-element-event-args-)">.trigger( element, event, [args] )</h4>
<p>Trigger events on some element. Element is required&#x2026;</p>
<h4 id=".emit(-action-data-)">.emit( action, [ data ] )</h4>
<p>Emit a custom event to be bubbled in the DOM tree.</p>
<h4 id=".listen(-event-function-)">.listen( Event, Function )</h4>
<p>Listen to custom events fired by Components or Controllers within the controller/app scope.</p>
<h4 id=".get(-cssselector-)">.get( CssSelector )</h4>
<p>Creates an reference to components, and returns a function, it accepts the name of public method and arguments to be sent as event. The previous example code illustrates that.</p>
<h4 id=".publish(-event-args-)">.publish( Event, [args] )</h4>
<p>Fires a global event to the ecosystem, very recommended to communicate Controllers and Apps with each other.</p>
<h4 id=".subscribe(-event-function-)-:-function-unsubscribe">.subscribe( Event, Function ) : Function unsubscribe</h4>
<p>Subscribes the Controller/App to a global event. Returns a function to unsubscribe if necessary.</p>

        </div>
        <div class="footer-nav">
          <div class="left"><a href="../getting-started/index.html"><span class="title">Getting Started</span></a></div>
          <div class="right"><a href="../jails-api/index.html"><span class="label">Next: </span><span class="title">Jails API</span></a></div>
        </div>
      </div>
      <div class="menu toc-menu">
        <li class="menu-item -level-0 -parent">
          <ul class="submenu">
            <li class="menu-item -level-1"><a href="../index.html" class="link title  link-index">Jails</a>
            </li>
            <li class="menu-item -level-1 -parent"><a href="../getting-started/index.html" class="link title  link-getting-started">Getting Started</a>
              <ul class="submenu">
                <li class="menu-item -level-2">
                </li>
              </ul>
            </li>
            <li class="menu-item -level-1 -parent"><a href="../components/index.html" class="link title -active link-components">Components</a>
              <ul class="headings heading-list">
                <li class="heading-item -depth-2"><a href="#passive-way" class="hlink link-passive-way">Passive way</a>
                  <ul class="heading-list -depth-2">
                    <li class="heading-item -depth-3"><a href="#example" class="hlink link-example">Example</a>
                    </li>
                  </ul>
                </li>
                <li class="heading-item -depth-2"><a href="#active-way" class="hlink link-active-way">Active way</a>
                  <ul class="heading-list -depth-2">
                    <li class="heading-item -depth-3"><a href="#example" class="hlink link-example">Example</a>
                    </li>
                    <li class="heading-item -depth-3"><a href="#example" class="hlink link-example">Example</a>
                    </li>
                  </ul>
                </li>
              </ul>
              <ul class="submenu">
                <li class="menu-item -level-2">
                </li>
              </ul>
            </li>
            <li class="menu-item -level-1 -parent"><a href="../jails-api/index.html" class="link title  link-jails-api">Jails API</a>
              <ul class="submenu">
                <li class="menu-item -level-2">
                </li>
              </ul>
            </li>
            <li class="menu-item -level-1 -parent"><a href="../downloads/index.html" class="link title  link-downloads">Downloads</a>
              <ul class="submenu">
                <li class="menu-item -level-2">
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </div>
    </div>
  </body>
</html>